{"ast":null,"code":"// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\nimport { Log } from './Log.js';\nconst DefaultTimeout = 10000;\nexport class IFrameWindow {\n  constructor(params) {\n    this._promise = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n    this._boundMessageEvent = this._message.bind(this);\n    window.addEventListener(\"message\", this._boundMessageEvent, false);\n    this._frame = window.document.createElement(\"iframe\"); // shotgun approach\n\n    this._frame.style.visibility = \"hidden\";\n    this._frame.style.position = \"absolute\";\n    this._frame.width = 0;\n    this._frame.height = 0;\n    window.document.body.appendChild(this._frame);\n  }\n\n  navigate(params) {\n    if (!params || !params.url) {\n      this._error(\"No url provided\");\n    } else {\n      let timeout = params.silentRequestTimeout || DefaultTimeout;\n      Log.debug(\"IFrameWindow.navigate: Using timeout of:\", timeout);\n      this._timer = window.setTimeout(this._timeout.bind(this), timeout);\n      this._frame.src = params.url;\n    }\n\n    return this.promise;\n  }\n\n  get promise() {\n    return this._promise;\n  }\n\n  _success(data) {\n    this._cleanup();\n\n    Log.debug(\"IFrameWindow: Successful response from frame window\");\n\n    this._resolve(data);\n  }\n\n  _error(message) {\n    this._cleanup();\n\n    Log.error(message);\n\n    this._reject(new Error(message));\n  }\n\n  close() {\n    this._cleanup();\n  }\n\n  _cleanup() {\n    if (this._frame) {\n      Log.debug(\"IFrameWindow: cleanup\");\n      window.removeEventListener(\"message\", this._boundMessageEvent, false);\n      window.clearTimeout(this._timer);\n      window.document.body.removeChild(this._frame);\n      this._timer = null;\n      this._frame = null;\n      this._boundMessageEvent = null;\n    }\n  }\n\n  _timeout() {\n    Log.debug(\"IFrameWindow.timeout\");\n\n    this._error(\"Frame window timed out\");\n  }\n\n  _message(e) {\n    Log.debug(\"IFrameWindow.message\");\n\n    if (this._timer && e.origin === this._origin && e.source === this._frame.contentWindow && typeof e.data === 'string' && (e.data.startsWith('http://') || e.data.startsWith('https://'))) {\n      let url = e.data;\n\n      if (url) {\n        this._success({\n          url: url\n        });\n      } else {\n        this._error(\"Invalid response from frame\");\n      }\n    }\n  }\n\n  get _origin() {\n    return location.protocol + \"//\" + location.host;\n  }\n\n  static notifyParent(url) {\n    Log.debug(\"IFrameWindow.notifyParent\");\n    url = url || window.location.href;\n\n    if (url) {\n      Log.debug(\"IFrameWindow.notifyParent: posting url message to parent\");\n      window.parent.postMessage(url, location.protocol + \"//\" + location.host);\n    }\n  }\n\n}","map":{"version":3,"names":["Log","DefaultTimeout","IFrameWindow","constructor","params","_promise","Promise","resolve","reject","_resolve","_reject","_boundMessageEvent","_message","bind","window","addEventListener","_frame","document","createElement","style","visibility","position","width","height","body","appendChild","navigate","url","_error","timeout","silentRequestTimeout","debug","_timer","setTimeout","_timeout","src","promise","_success","data","_cleanup","message","error","Error","close","removeEventListener","clearTimeout","removeChild","e","origin","_origin","source","contentWindow","startsWith","location","protocol","host","notifyParent","href","parent","postMessage"],"sources":["C:/Users/theoj/Desktop/WebbProject-Yr3-React18/ClientApp/node_modules/oidc-client/src/IFrameWindow.js"],"sourcesContent":["// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\r\n\r\nimport { Log } from './Log.js';\r\n\r\nconst DefaultTimeout = 10000;\r\n\r\nexport class IFrameWindow {\r\n\r\n    constructor(params) {\r\n        this._promise = new Promise((resolve, reject) => {\r\n            this._resolve = resolve;\r\n            this._reject = reject;\r\n        });\r\n\r\n        this._boundMessageEvent = this._message.bind(this);\r\n        window.addEventListener(\"message\", this._boundMessageEvent, false);\r\n\r\n        this._frame = window.document.createElement(\"iframe\");\r\n\r\n        // shotgun approach\r\n        this._frame.style.visibility = \"hidden\";\r\n        this._frame.style.position = \"absolute\";\r\n        this._frame.width = 0;\r\n        this._frame.height = 0;\r\n\r\n        window.document.body.appendChild(this._frame);\r\n    }\r\n\r\n    navigate(params) {\r\n        if (!params || !params.url) {\r\n            this._error(\"No url provided\");\r\n        }\r\n        else {\r\n            let timeout = params.silentRequestTimeout || DefaultTimeout;\r\n            Log.debug(\"IFrameWindow.navigate: Using timeout of:\", timeout);\r\n            this._timer = window.setTimeout(this._timeout.bind(this), timeout);\r\n            this._frame.src = params.url;\r\n        }\r\n\r\n        return this.promise;\r\n    }\r\n\r\n    get promise() {\r\n        return this._promise;\r\n    }\r\n\r\n    _success(data) {\r\n        this._cleanup();\r\n\r\n        Log.debug(\"IFrameWindow: Successful response from frame window\");\r\n        this._resolve(data);\r\n    }\r\n    _error(message) {\r\n        this._cleanup();\r\n\r\n        Log.error(message);\r\n        this._reject(new Error(message));\r\n    }\r\n\r\n    close() {\r\n        this._cleanup();\r\n    }\r\n\r\n    _cleanup() {\r\n        if (this._frame) {\r\n            Log.debug(\"IFrameWindow: cleanup\");\r\n\r\n            window.removeEventListener(\"message\", this._boundMessageEvent, false);\r\n            window.clearTimeout(this._timer);\r\n            window.document.body.removeChild(this._frame);\r\n\r\n            this._timer = null;\r\n            this._frame = null;\r\n            this._boundMessageEvent = null;\r\n        }\r\n    }\r\n\r\n    _timeout() {\r\n        Log.debug(\"IFrameWindow.timeout\");\r\n        this._error(\"Frame window timed out\");\r\n    }\r\n\r\n    _message(e) {\r\n        Log.debug(\"IFrameWindow.message\");\r\n\r\n        if (this._timer &&\r\n            e.origin === this._origin &&\r\n            e.source === this._frame.contentWindow &&\r\n            (typeof e.data === 'string' && (e.data.startsWith('http://') || e.data.startsWith('https://')))\r\n        ) {\r\n            let url = e.data;\r\n            if (url) {\r\n                this._success({ url: url });\r\n            }\r\n            else {\r\n                this._error(\"Invalid response from frame\");\r\n            }\r\n        }\r\n    }\r\n\r\n    get _origin() {\r\n        return location.protocol + \"//\" + location.host;\r\n    }\r\n\r\n    static notifyParent(url) {\r\n        Log.debug(\"IFrameWindow.notifyParent\");\r\n        url = url || window.location.href;\r\n        if (url) {\r\n            Log.debug(\"IFrameWindow.notifyParent: posting url message to parent\");\r\n            window.parent.postMessage(url, location.protocol + \"//\" + location.host);\r\n        }\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}