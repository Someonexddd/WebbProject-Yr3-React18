{"ast":null,"code":"// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\nimport { Log } from './Log.js';\nimport { UrlUtility } from './UrlUtility.js';\nconst CheckForPopupClosedInterval = 500;\nconst DefaultPopupFeatures = 'location=no,toolbar=no,width=500,height=500,left=100,top=100;'; //const DefaultPopupFeatures = 'location=no,toolbar=no,width=500,height=500,left=100,top=100;resizable=yes';\n\nconst DefaultPopupTarget = \"_blank\";\nexport class PopupWindow {\n  constructor(params) {\n    this._promise = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n    let target = params.popupWindowTarget || DefaultPopupTarget;\n    let features = params.popupWindowFeatures || DefaultPopupFeatures;\n    this._popup = window.open('', target, features);\n\n    if (this._popup) {\n      Log.debug(\"PopupWindow.ctor: popup successfully created\");\n      this._checkForPopupClosedTimer = window.setInterval(this._checkForPopupClosed.bind(this), CheckForPopupClosedInterval);\n    }\n  }\n\n  get promise() {\n    return this._promise;\n  }\n\n  navigate(params) {\n    if (!this._popup) {\n      this._error(\"PopupWindow.navigate: Error opening popup window\");\n    } else if (!params || !params.url) {\n      this._error(\"PopupWindow.navigate: no url provided\");\n\n      this._error(\"No url provided\");\n    } else {\n      Log.debug(\"PopupWindow.navigate: Setting URL in popup\");\n      this._id = params.id;\n\n      if (this._id) {\n        window[\"popupCallback_\" + params.id] = this._callback.bind(this);\n      }\n\n      this._popup.focus();\n\n      this._popup.window.location = params.url;\n    }\n\n    return this.promise;\n  }\n\n  _success(data) {\n    Log.debug(\"PopupWindow.callback: Successful response from popup window\");\n\n    this._cleanup();\n\n    this._resolve(data);\n  }\n\n  _error(message) {\n    Log.error(\"PopupWindow.error: \", message);\n\n    this._cleanup();\n\n    this._reject(new Error(message));\n  }\n\n  close() {\n    this._cleanup(false);\n  }\n\n  _cleanup(keepOpen) {\n    Log.debug(\"PopupWindow.cleanup\");\n    window.clearInterval(this._checkForPopupClosedTimer);\n    this._checkForPopupClosedTimer = null;\n    delete window[\"popupCallback_\" + this._id];\n\n    if (this._popup && !keepOpen) {\n      this._popup.close();\n    }\n\n    this._popup = null;\n  }\n\n  _checkForPopupClosed() {\n    if (!this._popup || this._popup.closed) {\n      this._error(\"Popup window closed\");\n    }\n  }\n\n  _callback(url, keepOpen) {\n    this._cleanup(keepOpen);\n\n    if (url) {\n      Log.debug(\"PopupWindow.callback success\");\n\n      this._success({\n        url: url\n      });\n    } else {\n      Log.debug(\"PopupWindow.callback: Invalid response from popup\");\n\n      this._error(\"Invalid response from popup\");\n    }\n  }\n\n  static notifyOpener(url, keepOpen, delimiter) {\n    if (window.opener) {\n      url = url || window.location.href;\n\n      if (url) {\n        var data = UrlUtility.parseUrlFragment(url, delimiter);\n\n        if (data.state) {\n          var name = \"popupCallback_\" + data.state;\n          var callback = window.opener[name];\n\n          if (callback) {\n            Log.debug(\"PopupWindow.notifyOpener: passing url message to opener\");\n            callback(url, keepOpen);\n          } else {\n            Log.warn(\"PopupWindow.notifyOpener: no matching callback found on opener\");\n          }\n        } else {\n          Log.warn(\"PopupWindow.notifyOpener: no state found in response url\");\n        }\n      }\n    } else {\n      Log.warn(\"PopupWindow.notifyOpener: no window.opener. Can't complete notification.\");\n    }\n  }\n\n}","map":{"version":3,"names":["Log","UrlUtility","CheckForPopupClosedInterval","DefaultPopupFeatures","DefaultPopupTarget","PopupWindow","constructor","params","_promise","Promise","resolve","reject","_resolve","_reject","target","popupWindowTarget","features","popupWindowFeatures","_popup","window","open","debug","_checkForPopupClosedTimer","setInterval","_checkForPopupClosed","bind","promise","navigate","_error","url","_id","id","_callback","focus","location","_success","data","_cleanup","message","error","Error","close","keepOpen","clearInterval","closed","notifyOpener","delimiter","opener","href","parseUrlFragment","state","name","callback","warn"],"sources":["C:/Users/theoj/Desktop/WebbProject-Yr3-React18/ClientApp/node_modules/oidc-client/src/PopupWindow.js"],"sourcesContent":["// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\r\n\r\nimport { Log } from './Log.js';\r\nimport { UrlUtility } from './UrlUtility.js';\r\n\r\nconst CheckForPopupClosedInterval = 500;\r\nconst DefaultPopupFeatures = 'location=no,toolbar=no,width=500,height=500,left=100,top=100;';\r\n//const DefaultPopupFeatures = 'location=no,toolbar=no,width=500,height=500,left=100,top=100;resizable=yes';\r\n\r\nconst DefaultPopupTarget = \"_blank\";\r\n\r\nexport class PopupWindow {\r\n\r\n    constructor(params) {\r\n        this._promise = new Promise((resolve, reject) => {\r\n            this._resolve = resolve;\r\n            this._reject = reject;\r\n        });\r\n\r\n        let target = params.popupWindowTarget || DefaultPopupTarget;\r\n        let features = params.popupWindowFeatures || DefaultPopupFeatures;\r\n\r\n        this._popup = window.open('', target, features);\r\n        if (this._popup) {\r\n            Log.debug(\"PopupWindow.ctor: popup successfully created\");\r\n            this._checkForPopupClosedTimer = window.setInterval(this._checkForPopupClosed.bind(this), CheckForPopupClosedInterval);\r\n        }\r\n    }\r\n\r\n    get promise() {\r\n        return this._promise;\r\n    }\r\n\r\n    navigate(params) {\r\n        if (!this._popup) {\r\n            this._error(\"PopupWindow.navigate: Error opening popup window\");\r\n        }\r\n        else if (!params || !params.url) {\r\n            this._error(\"PopupWindow.navigate: no url provided\");\r\n            this._error(\"No url provided\");\r\n        }\r\n        else {\r\n            Log.debug(\"PopupWindow.navigate: Setting URL in popup\");\r\n\r\n            this._id = params.id;\r\n            if (this._id) {\r\n                window[\"popupCallback_\" + params.id] = this._callback.bind(this);\r\n            }\r\n\r\n            this._popup.focus();\r\n            this._popup.window.location = params.url;\r\n        }\r\n\r\n        return this.promise;\r\n    }\r\n\r\n    _success(data) {\r\n        Log.debug(\"PopupWindow.callback: Successful response from popup window\");\r\n\r\n        this._cleanup();\r\n        this._resolve(data);\r\n    }\r\n    _error(message) {\r\n        Log.error(\"PopupWindow.error: \", message);\r\n        \r\n        this._cleanup();\r\n        this._reject(new Error(message));\r\n    }\r\n\r\n    close() {\r\n        this._cleanup(false);\r\n    }\r\n\r\n    _cleanup(keepOpen) {\r\n        Log.debug(\"PopupWindow.cleanup\");\r\n\r\n        window.clearInterval(this._checkForPopupClosedTimer);\r\n        this._checkForPopupClosedTimer = null;\r\n\r\n        delete window[\"popupCallback_\" + this._id];\r\n\r\n        if (this._popup && !keepOpen) {\r\n            this._popup.close();\r\n        }\r\n        this._popup = null;\r\n    }\r\n\r\n    _checkForPopupClosed() {\r\n        if (!this._popup || this._popup.closed) {\r\n            this._error(\"Popup window closed\");\r\n        }\r\n    }\r\n\r\n    _callback(url, keepOpen) {\r\n        this._cleanup(keepOpen);\r\n\r\n        if (url) {\r\n            Log.debug(\"PopupWindow.callback success\");\r\n            this._success({ url: url });\r\n        }\r\n        else {\r\n            Log.debug(\"PopupWindow.callback: Invalid response from popup\");\r\n            this._error(\"Invalid response from popup\");\r\n        }\r\n    }\r\n\r\n    static notifyOpener(url, keepOpen, delimiter) {\r\n        if (window.opener) {\r\n            url = url || window.location.href;\r\n            if (url) {\r\n                var data = UrlUtility.parseUrlFragment(url, delimiter);\r\n\r\n                if (data.state) {\r\n                    var name = \"popupCallback_\" + data.state;\r\n                    var callback = window.opener[name];\r\n                    if (callback) {\r\n                        Log.debug(\"PopupWindow.notifyOpener: passing url message to opener\");\r\n                        callback(url, keepOpen);\r\n                    }\r\n                    else {\r\n                        Log.warn(\"PopupWindow.notifyOpener: no matching callback found on opener\");\r\n                    }\r\n                }\r\n                else {\r\n                    Log.warn(\"PopupWindow.notifyOpener: no state found in response url\");\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            Log.warn(\"PopupWindow.notifyOpener: no window.opener. Can't complete notification.\");\r\n        }\r\n    }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}