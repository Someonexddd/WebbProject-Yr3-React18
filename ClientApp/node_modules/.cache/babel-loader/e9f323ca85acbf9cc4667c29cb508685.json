{"ast":null,"code":"// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\nimport { Log } from './Log.js';\nconst DefaultInterval = 2000;\nexport class CheckSessionIFrame {\n  constructor(callback, client_id, url, interval) {\n    let stopOnError = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : true;\n    this._callback = callback;\n    this._client_id = client_id;\n    this._url = url;\n    this._interval = interval || DefaultInterval;\n    this._stopOnError = stopOnError;\n    var idx = url.indexOf(\"/\", url.indexOf(\"//\") + 2);\n    this._frame_origin = url.substr(0, idx);\n    this._frame = window.document.createElement(\"iframe\"); // shotgun approach\n\n    this._frame.style.visibility = \"hidden\";\n    this._frame.style.position = \"absolute\";\n    this._frame.style.display = \"none\";\n    this._frame.width = 0;\n    this._frame.height = 0;\n    this._frame.src = url;\n  }\n\n  load() {\n    return new Promise(resolve => {\n      this._frame.onload = () => {\n        resolve();\n      };\n\n      window.document.body.appendChild(this._frame);\n      this._boundMessageEvent = this._message.bind(this);\n      window.addEventListener(\"message\", this._boundMessageEvent, false);\n    });\n  }\n\n  _message(e) {\n    if (e.origin === this._frame_origin && e.source === this._frame.contentWindow) {\n      if (e.data === \"error\") {\n        Log.error(\"CheckSessionIFrame: error message from check session op iframe\");\n\n        if (this._stopOnError) {\n          this.stop();\n        }\n      } else if (e.data === \"changed\") {\n        Log.debug(\"CheckSessionIFrame: changed message from check session op iframe\");\n        this.stop();\n\n        this._callback();\n      } else {\n        Log.debug(\"CheckSessionIFrame: \" + e.data + \" message from check session op iframe\");\n      }\n    }\n  }\n\n  start(session_state) {\n    if (this._session_state !== session_state) {\n      Log.debug(\"CheckSessionIFrame.start\");\n      this.stop();\n      this._session_state = session_state;\n\n      let send = () => {\n        this._frame.contentWindow.postMessage(this._client_id + \" \" + this._session_state, this._frame_origin);\n      }; // trigger now\n\n\n      send(); // and setup timer\n\n      this._timer = window.setInterval(send, this._interval);\n    }\n  }\n\n  stop() {\n    this._session_state = null;\n\n    if (this._timer) {\n      Log.debug(\"CheckSessionIFrame.stop\");\n      window.clearInterval(this._timer);\n      this._timer = null;\n    }\n  }\n\n}","map":{"version":3,"names":["Log","DefaultInterval","CheckSessionIFrame","constructor","callback","client_id","url","interval","stopOnError","_callback","_client_id","_url","_interval","_stopOnError","idx","indexOf","_frame_origin","substr","_frame","window","document","createElement","style","visibility","position","display","width","height","src","load","Promise","resolve","onload","body","appendChild","_boundMessageEvent","_message","bind","addEventListener","e","origin","source","contentWindow","data","error","stop","debug","start","session_state","_session_state","send","postMessage","_timer","setInterval","clearInterval"],"sources":["C:/Users/theoj/Desktop/WebbProject-Yr3-React18/ClientApp/node_modules/oidc-client/src/CheckSessionIFrame.js"],"sourcesContent":["// Copyright (c) Brock Allen & Dominick Baier. All rights reserved.\r\n// Licensed under the Apache License, Version 2.0. See LICENSE in the project root for license information.\r\n\r\nimport { Log } from './Log.js';\r\n\r\nconst DefaultInterval = 2000;\r\n\r\nexport class CheckSessionIFrame {\r\n    constructor(callback, client_id, url, interval, stopOnError = true) {\r\n        this._callback = callback;\r\n        this._client_id = client_id;\r\n        this._url = url;\r\n        this._interval = interval || DefaultInterval;\r\n        this._stopOnError = stopOnError;\r\n\r\n        var idx = url.indexOf(\"/\", url.indexOf(\"//\") + 2);\r\n        this._frame_origin = url.substr(0, idx);\r\n\r\n        this._frame = window.document.createElement(\"iframe\");\r\n\r\n        // shotgun approach\r\n        this._frame.style.visibility = \"hidden\";\r\n        this._frame.style.position = \"absolute\";\r\n        this._frame.style.display = \"none\";\r\n        this._frame.width = 0;\r\n        this._frame.height = 0;\r\n\r\n        this._frame.src = url;\r\n    }\r\n    load() {\r\n        return new Promise((resolve) => {\r\n            this._frame.onload = () => {\r\n                resolve();\r\n            }\r\n\r\n            window.document.body.appendChild(this._frame);\r\n            this._boundMessageEvent = this._message.bind(this);\r\n            window.addEventListener(\"message\", this._boundMessageEvent, false);\r\n        });\r\n    }\r\n    _message(e) {\r\n        if (e.origin === this._frame_origin &&\r\n            e.source === this._frame.contentWindow\r\n        ) {\r\n            if (e.data === \"error\") {\r\n                Log.error(\"CheckSessionIFrame: error message from check session op iframe\");\r\n                if (this._stopOnError) {\r\n                    this.stop();\r\n                }\r\n            }\r\n            else if (e.data === \"changed\") {\r\n                Log.debug(\"CheckSessionIFrame: changed message from check session op iframe\");\r\n                this.stop();\r\n                this._callback();\r\n            }\r\n            else {\r\n                Log.debug(\"CheckSessionIFrame: \" + e.data + \" message from check session op iframe\");\r\n            }\r\n        }\r\n    }\r\n    start(session_state) {\r\n        if (this._session_state !== session_state) {\r\n            Log.debug(\"CheckSessionIFrame.start\");\r\n\r\n            this.stop();\r\n\r\n            this._session_state = session_state;\r\n\r\n            let send = () => {\r\n                this._frame.contentWindow.postMessage(this._client_id + \" \" + this._session_state, this._frame_origin);\r\n            };\r\n            \r\n            // trigger now\r\n            send();\r\n\r\n            // and setup timer\r\n            this._timer = window.setInterval(send, this._interval);\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        this._session_state = null;\r\n\r\n        if (this._timer) {\r\n            Log.debug(\"CheckSessionIFrame.stop\");\r\n\r\n            window.clearInterval(this._timer);\r\n            this._timer = null;\r\n        }\r\n    }\r\n}\r\n"],"mappings":"AAAA;AACA;AAEA,SAASA,GAAT,QAAoB,UAApB;AAEA,MAAMC,eAAe,GAAG,IAAxB;AAEA,OAAO,MAAMC,kBAAN,CAAyB;EAC5BC,WAAW,CAACC,QAAD,EAAWC,SAAX,EAAsBC,GAAtB,EAA2BC,QAA3B,EAAyD;IAAA,IAApBC,WAAoB,uEAAN,IAAM;IAChE,KAAKC,SAAL,GAAiBL,QAAjB;IACA,KAAKM,UAAL,GAAkBL,SAAlB;IACA,KAAKM,IAAL,GAAYL,GAAZ;IACA,KAAKM,SAAL,GAAiBL,QAAQ,IAAIN,eAA7B;IACA,KAAKY,YAAL,GAAoBL,WAApB;IAEA,IAAIM,GAAG,GAAGR,GAAG,CAACS,OAAJ,CAAY,GAAZ,EAAiBT,GAAG,CAACS,OAAJ,CAAY,IAAZ,IAAoB,CAArC,CAAV;IACA,KAAKC,aAAL,GAAqBV,GAAG,CAACW,MAAJ,CAAW,CAAX,EAAcH,GAAd,CAArB;IAEA,KAAKI,MAAL,GAAcC,MAAM,CAACC,QAAP,CAAgBC,aAAhB,CAA8B,QAA9B,CAAd,CAVgE,CAYhE;;IACA,KAAKH,MAAL,CAAYI,KAAZ,CAAkBC,UAAlB,GAA+B,QAA/B;IACA,KAAKL,MAAL,CAAYI,KAAZ,CAAkBE,QAAlB,GAA6B,UAA7B;IACA,KAAKN,MAAL,CAAYI,KAAZ,CAAkBG,OAAlB,GAA4B,MAA5B;IACA,KAAKP,MAAL,CAAYQ,KAAZ,GAAoB,CAApB;IACA,KAAKR,MAAL,CAAYS,MAAZ,GAAqB,CAArB;IAEA,KAAKT,MAAL,CAAYU,GAAZ,GAAkBtB,GAAlB;EACH;;EACDuB,IAAI,GAAG;IACH,OAAO,IAAIC,OAAJ,CAAaC,OAAD,IAAa;MAC5B,KAAKb,MAAL,CAAYc,MAAZ,GAAqB,MAAM;QACvBD,OAAO;MACV,CAFD;;MAIAZ,MAAM,CAACC,QAAP,CAAgBa,IAAhB,CAAqBC,WAArB,CAAiC,KAAKhB,MAAtC;MACA,KAAKiB,kBAAL,GAA0B,KAAKC,QAAL,CAAcC,IAAd,CAAmB,IAAnB,CAA1B;MACAlB,MAAM,CAACmB,gBAAP,CAAwB,SAAxB,EAAmC,KAAKH,kBAAxC,EAA4D,KAA5D;IACH,CARM,CAAP;EASH;;EACDC,QAAQ,CAACG,CAAD,EAAI;IACR,IAAIA,CAAC,CAACC,MAAF,KAAa,KAAKxB,aAAlB,IACAuB,CAAC,CAACE,MAAF,KAAa,KAAKvB,MAAL,CAAYwB,aAD7B,EAEE;MACE,IAAIH,CAAC,CAACI,IAAF,KAAW,OAAf,EAAwB;QACpB3C,GAAG,CAAC4C,KAAJ,CAAU,gEAAV;;QACA,IAAI,KAAK/B,YAAT,EAAuB;UACnB,KAAKgC,IAAL;QACH;MACJ,CALD,MAMK,IAAIN,CAAC,CAACI,IAAF,KAAW,SAAf,EAA0B;QAC3B3C,GAAG,CAAC8C,KAAJ,CAAU,kEAAV;QACA,KAAKD,IAAL;;QACA,KAAKpC,SAAL;MACH,CAJI,MAKA;QACDT,GAAG,CAAC8C,KAAJ,CAAU,yBAAyBP,CAAC,CAACI,IAA3B,GAAkC,uCAA5C;MACH;IACJ;EACJ;;EACDI,KAAK,CAACC,aAAD,EAAgB;IACjB,IAAI,KAAKC,cAAL,KAAwBD,aAA5B,EAA2C;MACvChD,GAAG,CAAC8C,KAAJ,CAAU,0BAAV;MAEA,KAAKD,IAAL;MAEA,KAAKI,cAAL,GAAsBD,aAAtB;;MAEA,IAAIE,IAAI,GAAG,MAAM;QACb,KAAKhC,MAAL,CAAYwB,aAAZ,CAA0BS,WAA1B,CAAsC,KAAKzC,UAAL,GAAkB,GAAlB,GAAwB,KAAKuC,cAAnE,EAAmF,KAAKjC,aAAxF;MACH,CAFD,CAPuC,CAWvC;;;MACAkC,IAAI,GAZmC,CAcvC;;MACA,KAAKE,MAAL,GAAcjC,MAAM,CAACkC,WAAP,CAAmBH,IAAnB,EAAyB,KAAKtC,SAA9B,CAAd;IACH;EACJ;;EAEDiC,IAAI,GAAG;IACH,KAAKI,cAAL,GAAsB,IAAtB;;IAEA,IAAI,KAAKG,MAAT,EAAiB;MACbpD,GAAG,CAAC8C,KAAJ,CAAU,yBAAV;MAEA3B,MAAM,CAACmC,aAAP,CAAqB,KAAKF,MAA1B;MACA,KAAKA,MAAL,GAAc,IAAd;IACH;EACJ;;AAlF2B"},"metadata":{},"sourceType":"module"}